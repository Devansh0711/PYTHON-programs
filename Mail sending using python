import smtplib
from email import message
from os.path import basename
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.mime.application import MIMEApplication
# built-in "smtplib" module to send email using SMTP (Simple Mail Transfer Protocol)

server = smtplib.SMTP_SSL('smtp.gmail.com', 465)


guser = 'thisisraptor07@gmail.com'
gpass = '07thisisraptor'


# Can add receivers from here
to = ['thisisraptor07@gmail.com']
subject = 'Test run of sending mail with python'
body = 'This is the test run of sending mail with python'
# Contents of the mail


msg = f'subject: {subject}\n\n{body}'


while True:
    print('''
    ▄▀█ █░█ ▀█▀ █▀█ █▀▄▀█ ▄▀█ ▀█▀ █ █▀█ █▄░█   █▀█ █▀▀   █▀▄▀█ ▄▀█ █ █░░   █▀ █▀▀ █▄░█ █▀▄ █ █▄░█ █▀▀
    █▀█ █▄█ ░█░ █▄█ █░▀░█ █▀█ ░█░ █ █▄█ █░▀█   █▄█ █▀░   █░▀░█ █▀█ █ █▄▄   ▄█ ██▄ █░▀█ █▄▀ █ █░▀█ █▄█
    Enter your choice: ''')
    choice = int(
        input("1.Only for text mail\n2.Mail with attachment\n3.exit\n "))
    if choice == 1:
        try:
            server.login(guser, gpass)  # Logging in using the gmail id

            server.sendmail(guser, to, msg)
            #server.sendmail("Sender", "Receiver", "Message")

            server.quit()
            print('Mail sent sucessfully')

        except:

            print('Unable to send mail')

    elif choice == 2:
        try:
            server.login(guser, gpass)
            msg = MIMEMultipart()
            msg['From'] = guser
            msg['To'] = to
            msg['Subject'] = subject
            body = MIMEText(body, 'plain')
            msg.attach(body)
            filename = 'text.txt'
            with open(filename, 'r') as f:
                part = MIMEApplication(f.read(), Name=basename(filename))
                part['Content-Disposition'] = 'attachment; filename="{}"'.format(basename(filename))
                msg.attach(part)

                
                server.send_message(msg, guser, to)

                
                print('Mail sent sucessfully')
            
        except:
            print('Unable to send mail')

    elif choice == 3:
        exit()

    else:
        print("Wrong choice")
